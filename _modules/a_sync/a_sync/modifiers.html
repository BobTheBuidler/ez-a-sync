

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>a_sync.a_sync.modifiers &mdash; ez-a-sync  documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=e59714d7" />

  
      <script src="../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            ez-a-sync
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../source/modules.html">a_sync</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">ez-a-sync</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">a_sync.a_sync.modifiers</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for a_sync.a_sync.modifiers</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">This file contains all logic for ez-a-sync&#39;s &quot;modifiers&quot;.</span>

<span class="sd">Modifiers modify the behavior of ez-a-sync&#39;s ASync objects in various ways.</span>

<span class="sd">Submodules:</span>
<span class="sd">    cache: Handles caching mechanisms for async functions.</span>
<span class="sd">    limiter: Manages rate limiting for async functions.</span>
<span class="sd">    manager: Provides management of valid modifiers and their application.</span>
<span class="sd">    semaphores: Implements semaphore logic for controlling concurrency.</span>

<span class="sd">The modifiers available are:</span>
<span class="sd">- `cache_type`: Specifies the type of cache to use, such as &#39;memory&#39;.</span>
<span class="sd">- `cache_typed`: Determines if types are considered for cache keys.</span>
<span class="sd">- `ram_cache_maxsize`: Sets the maximum size for the LRU cache.</span>
<span class="sd">- `ram_cache_ttl`: Defines the time-to-live for items in the cache.</span>
<span class="sd">- `runs_per_minute`: Sets a rate limit for function execution.</span>
<span class="sd">- `semaphore`: Specifies a semaphore for controlling concurrency.</span>
<span class="sd">- `executor`: Defines the executor for synchronous functions. This is not applied like the other modifiers but is used to manage the execution context for synchronous functions when they are called in an asynchronous manner.</span>

<span class="sd">See Also:</span>
<span class="sd">    - :mod:`a_sync.a_sync.modifiers.cache`</span>
<span class="sd">    - :mod:`a_sync.a_sync.modifiers.limiter`</span>
<span class="sd">    - :mod:`a_sync.a_sync.modifiers.manager`</span>
<span class="sd">    - :mod:`a_sync.a_sync.modifiers.semaphores`</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">aiolimiter</span><span class="w"> </span><span class="kn">import</span> <span class="n">AsyncLimiter</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">a_sync._typing</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">a_sync.primitives.locks</span><span class="w"> </span><span class="kn">import</span> <span class="n">ThreadsafeSemaphore</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">a_sync.a_sync.modifiers.manager</span><span class="w"> </span><span class="kn">import</span> <span class="n">valid_modifiers</span>


<div class="viewcode-block" id="get_modifiers_from">
<a class="viewcode-back" href="../../../source/a_sync.a_sync.modifiers.html#a_sync.a_sync.modifiers.get_modifiers_from">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">get_modifiers_from</span><span class="p">(</span><span class="n">thing</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">dict</span><span class="p">,</span> <span class="nb">type</span><span class="p">,</span> <span class="nb">object</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">ModifierKwargs</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Extracts valid modifiers from a given object, type, or dictionary.</span>

<span class="sd">    Args:</span>
<span class="sd">        thing: The source from which to extract modifiers. It can be a dictionary,</span>
<span class="sd">            a type, or an object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A ModifierKwargs object containing the valid modifiers extracted from the input.</span>

<span class="sd">    Examples:</span>
<span class="sd">        Extracting modifiers from a class:</span>

<span class="sd">        &gt;&gt;&gt; class Example:</span>
<span class="sd">        ...     cache_type = &#39;memory&#39;</span>
<span class="sd">        ...     runs_per_minute = 60</span>
<span class="sd">        &gt;&gt;&gt; get_modifiers_from(Example)</span>
<span class="sd">        ModifierKwargs({&#39;cache_type&#39;: &#39;memory&#39;, &#39;runs_per_minute&#39;: 60})</span>

<span class="sd">        Extracting modifiers from a dictionary:</span>

<span class="sd">        &gt;&gt;&gt; modifiers_dict = {&#39;cache_type&#39;: &#39;memory&#39;, &#39;semaphore&#39;: 5}</span>
<span class="sd">        &gt;&gt;&gt; get_modifiers_from(modifiers_dict)</span>
<span class="sd">        ModifierKwargs({&#39;cache_type&#39;: &#39;memory&#39;, &#39;semaphore&#39;: ThreadsafeSemaphore(5)})</span>

<span class="sd">    See Also:</span>
<span class="sd">        - :class:`a_sync.a_sync.modifiers.manager.ModifierManager`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">thing</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">apply_class_defined_modifiers</span><span class="p">(</span><span class="n">thing</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ModifierKwargs</span><span class="p">({</span><span class="n">modifier</span><span class="p">:</span> <span class="n">thing</span><span class="p">[</span><span class="n">modifier</span><span class="p">]</span> <span class="k">for</span> <span class="n">modifier</span> <span class="ow">in</span> <span class="n">valid_modifiers</span> <span class="k">if</span> <span class="n">modifier</span> <span class="ow">in</span> <span class="n">thing</span><span class="p">})</span>  <span class="c1"># type: ignore [misc]</span>
    <span class="k">return</span> <span class="n">ModifierKwargs</span><span class="p">({</span><span class="n">modifier</span><span class="p">:</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">thing</span><span class="p">,</span> <span class="n">modifier</span><span class="p">)</span> <span class="k">for</span> <span class="n">modifier</span> <span class="ow">in</span> <span class="n">valid_modifiers</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">thing</span><span class="p">,</span> <span class="n">modifier</span><span class="p">)})</span>  <span class="c1"># type: ignore [misc]</span></div>



<div class="viewcode-block" id="apply_class_defined_modifiers">
<a class="viewcode-back" href="../../../source/a_sync.a_sync.modifiers.html#a_sync.a_sync.modifiers.apply_class_defined_modifiers">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">apply_class_defined_modifiers</span><span class="p">(</span><span class="n">attrs_from_metaclass</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Applies class-defined modifiers to a dictionary of attributes.</span>

<span class="sd">    This function modifies the input dictionary in place. If the &#39;semaphore&#39; key</span>
<span class="sd">    is present and its value is an integer, it is converted to a ThreadsafeSemaphore.</span>
<span class="sd">    If the &#39;runs_per_minute&#39; key is present and its value is an integer, it is</span>
<span class="sd">    converted to an AsyncLimiter. If these keys are not present or their values</span>
<span class="sd">    are not integers, the function will silently do nothing.</span>

<span class="sd">    Args:</span>
<span class="sd">        attrs_from_metaclass: A dictionary of attributes from a metaclass.</span>

<span class="sd">    Examples:</span>
<span class="sd">        Applying modifiers to a dictionary:</span>

<span class="sd">        &gt;&gt;&gt; attrs = {&#39;semaphore&#39;: 3, &#39;runs_per_minute&#39;: 60}</span>
<span class="sd">        &gt;&gt;&gt; apply_class_defined_modifiers(attrs)</span>
<span class="sd">        &gt;&gt;&gt; attrs[&#39;semaphore&#39;]</span>
<span class="sd">        ThreadsafeSemaphore(3)</span>

<span class="sd">        &gt;&gt;&gt; attrs[&#39;runs_per_minute&#39;]</span>
<span class="sd">        AsyncLimiter(60)</span>

<span class="sd">    See Also:</span>
<span class="sd">        - :class:`a_sync.primitives.locks.ThreadsafeSemaphore`</span>
<span class="sd">        - :class:`aiolimiter.AsyncLimiter`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span> <span class="o">:=</span> <span class="n">attrs_from_metaclass</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;semaphore&quot;</span><span class="p">),</span> <span class="nb">int</span><span class="p">):</span>
        <span class="n">attrs_from_metaclass</span><span class="p">[</span><span class="s2">&quot;semaphore&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ThreadsafeSemaphore</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span> <span class="o">:=</span> <span class="n">attrs_from_metaclass</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;runs_per_minute&quot;</span><span class="p">),</span> <span class="nb">int</span><span class="p">):</span>
        <span class="n">attrs_from_metaclass</span><span class="p">[</span><span class="s2">&quot;runs_per_minute&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">AsyncLimiter</span><span class="p">(</span><span class="n">val</span><span class="p">)</span></div>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, BobTheBuidler.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>